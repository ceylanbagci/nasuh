{% extends "home/base.html" %}
{% load humanize %}

{% block head %}
{{form.media}}
{% endblock %}

{% block content %}
<!--begin::Entry-->
<div class="d-flex flex-column-fluid">
	<!--begin::Container-->
	<div class="container">
		<!--begin::Card-->
		<div class="card card-custom gutter-b">
			<div class="card-body">
				<!--begin::Details-->
				<div class="d-flex mb-9">
					<!--begin: Pic-->
					<div class="flex-shrink-0 mr-7 mt-lg-0 mt-3">
						<div class="symbol symbol-50 symbol-lg-120">
							<img src="/static/assets/media/svg/icons/Clothes/T-shirt.svg" style="width:120px;"/>
						</div>
						<div class="symbol symbol-50 symbol-lg-120 symbol-primary d-none">
							<span class="font-size-h3 symbol-label font-weight-boldest">JM</span>
						</div>
					</div>
					<!--end::Pic-->
					<!--begin::Info-->
					<div class="flex-grow-1">
						<!--begin::Title-->
						<div class="d-flex justify-content-between flex-wrap mt-1">
							<div class="d-flex mr-3">
								<a href="#" class="text-dark-75 text-hover-primary font-size-h5 font-weight-bold mr-3">{{client.full_name}}</a>
								<a href="#">
									<i class="flaticon2-correct text-success font-size-h5"></i>
								</a>
							</div>
							<div class="my-lg-0 my-3">
								<a href="/case/{{client.slug}}/update_client" class="btn btn-sm btn-info font-weight-bolder text-uppercase mr-3">Düzenle</a>
								<a href="/case/{{client.slug}}/delete_client" class="btn btn-sm btn-light-danger font-weight-bolder text-uppercase btn-delete-confirmation">Sil</a>
							</div>
						</div>
						<!--end::Title-->
						<!--begin::Content-->
						<div class="d-flex flex-wrap justify-content-between mt-1">
							<div class="d-flex flex-column flex-grow-1 pr-8">
								<div class="d-flex flex-wrap mb-4">
									<a href="#" class="text-dark-50 text-hover-primary font-weight-bold mr-lg-8 mr-5 mb-lg-0 mb-2">
									<i class="flaticon2-new-email mr-2 font-size-lg"></i>{{client.email}}</a>
									<a href="#" class="text-dark-50 text-hover-primary font-weight-bold mr-lg-8 mr-5 mb-lg-0 mb-2">
									<i class="flaticon2-phone mr-2 font-size-lg"></i>{{client.phone}}</a>
									<a href="#" class="text-dark-50 text-hover-primary font-weight-bold">
									<i class="flaticon2-location mr-2 font-size-lg"></i>{{client.city}} / {{client.district}}</a>
								</div>
								<span class="font-weight-bold text-dark-50">{{client.description}}</span>
								<div class="d-flex flex-wrap align-items-center py-2">
									<div class="d-flex align-items-center mr-10">
										<div class="mr-6">
											<div class="font-weight-bold mb-2">Oluşturulma Tarihi</div>
											<span class="btn btn-sm btn-text btn-light-primary text-uppercase font-weight-bold">{{client.created_at}}</span>
										</div>

										<div class="mr-6">
											<div class="font-weight-bold mb-2">Dosyalar</div>
											{%for case in client.cases.all%}
												<span class="btn btn-sm btn-light-danger btn-text text-uppercase font-weight-bold">{{case.title}}</span>
											{%endfor%}
										</div>


									</div>

								</div>
							</div>
						</div>
						<!--end::Content-->
					</div>
					<!--end::Info-->
				</div>
				<!--end::Details-->
				<div class="separator separator-solid"></div>
				<!--begin::Items-->
				<div class="d-flex align-items-center flex-wrap mt-8" style="margin-left:145px;">
					<!--begin: Item-->
					<div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
						<span class="mr-4">
							<i class="flaticon-piggy-bank icon-2x text-muted font-weight-bold"></i>
						</span>
						<div class="d-flex flex-column text-dark-75">
							<span class="font-weight-bolder font-size-sm">Gelir</span>
							<span class="font-weight-bolder font-size-h5">
							<span class="text-dark-50 font-weight-bold"></span>{{client.get_stats.total_income.sum.humanize|intcomma}} ₺</span>
						</div>
					</div>
					<!--end: Item-->
					<!--begin: Item-->
					<div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
						<span class="mr-4">
							<i class="flaticon-confetti icon-2x text-muted font-weight-bold"></i>
						</span>
						<div class="d-flex flex-column text-dark-75">
							<span class="font-weight-bolder font-size-sm">Gider</span>
							<span class="font-weight-bolder font-size-h5">
							<span class="text-dark-50 font-weight-bold"></span>{{client.get_stats.total_spent.sum.humanize|intcomma}} ₺</span>
						</div>
					</div>
					<!--end: Item-->
					<!--begin: Item-->
					<div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
						<span class="mr-4">
							<i class="flaticon-pie-chart icon-2x text-muted font-weight-bold"></i>
						</span>
						<div class="d-flex flex-column text-dark-75">
							<span class="font-weight-bolder font-size-sm">Kâr</span>
							<span class="font-weight-bolder font-size-h5">
							<span class="text-dark-50 font-weight-bold"></span>{{client.get_stats.get_difference.humanize|intcomma}} ₺</span>
						</div>
					</div>
					<!--end: Item-->
					<!--begin: Item-->
					<div class="d-flex align-items-center flex-lg-fill mr-5 my-1">
						<span class="mr-4">
							<i class="flaticon-file-2 icon-2x text-muted font-weight-bold"></i>
						</span>
						<div class="d-flex flex-column flex-lg-fill">
							<span class="text-dark-75 font-weight-bolder font-size-sm">Toplam Hesap  Hareketi</span>
							<a href="#" class="text-primary font-weight-bolder">{{client.get_stats.total}}</a>
						</div>
					</div>
					<!--end: Item-->
				</div>
				<!--begin::Items-->
			</div>
		</div>
		<!--end::Card-->
		<!--begin::Row-->
		<div class="row">
			<div class="col-lg-12">
				<!--begin::Advance Table Widget 3-->
				<div class="card card-custom card-stretch gutter-b">
					<!--begin::Header-->
					<div class="card-header border-0 py-5">
						<h3 class="card-title align-items-start flex-column">
							<span class="card-label font-weight-bolder text-dark">Müvekkil Hesap Hareketleri</span>
							<span class="text-muted mt-3 font-weight-bold font-size-sm">Toplam {{client.get_stats.total}}</span>
						</h3>
						<div class="card-toolbar">

						</div>
					</div>
					<!--end::Header-->
					<!--begin::Body-->
					<div class="card-body pt-0 pb-3">
						<!--begin::Table-->
						<div class="table-responsive">
							<table class="table table-head-custom table-head-bg table-borderless table-vertical-center">
								<thead>
									<tr class="text-uppercase">
										<th class="pl-7">
											<span>Gelir Gider Türü</span>
										</th>
										<th >Dosya</th>
										<th >Gelir</th>
										<th >Gider</th>
										<th >Tarih</th>
										<th >Düzenle</th>
									</tr>
								</thead>
								<tbody>
						{%for trans in results%}
						<tr>
							<td>
								<span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{trans.expense.title}}</span>
								<span class="text-muted font-weight-bold">{{trans.case.description}}</span>
							</td>
							<td>
								<span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{trans.case.title}}</span>
							</td>
							<td>
								{%if trans.type == 1%}
								<span class="label label-lg label-light-success label-inline font-weight-bolder">{{trans.amount|intcomma}}₺</span>
								{%endif%}
							</td>
							<td>
								{%if trans.type == 2%}
								<span class="label label-lg label-light-danger label-inline font-weight-bolder">{{trans.amount|intcomma}}₺</span>
								{%endif%}
							</td>
							<td>
								<span class="text-dark-75 font-weight-bolder d-block font-size-lg">{{trans.date}}</span>
								<span class="text-muted font-weight-bold">{{trans.description}}</span>
							</td>

							<td class="text-right pr-0">
								<a href="/transactions/{{trans.id}}/delete" class="btn btn-icon btn-light btn-hover-primary btn-sm mr-3 btn-delete-confirmation">
									<span class="svg-icon svg-icon-primary svg-icon"><!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-02-01-052524/theme/html/demo9/dist/../src/media/svg/icons/Home/Trash.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24"/>
											<path d="M6,8 L18,8 L17.106535,19.6150447 C17.04642,20.3965405 16.3947578,21 15.6109533,21 L8.38904671,21 C7.60524225,21 6.95358004,20.3965405 6.89346498,19.6150447 L6,8 Z M8,10 L8.45438229,14.0894406 L15.5517885,14.0339036 L16,10 L8,10 Z" fill="#000000" fill-rule="nonzero"/>
											<path d="M14,4.5 L14,3.5 C14,3.22385763 13.7761424,3 13.5,3 L10.5,3 C10.2238576,3 10,3.22385763 10,3.5 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3"/>
										</g>
									</svg><!--end::Svg Icon--></span>
								</a>

							</td>
						</tr>
						{%endfor%}
						<div class="separator separator-solid my-7"></div>
						<tr>
							<td>
								<span class="text-dark-75 font-weight-bolder d-block font-size-lg">Toplam</span>
								<span class="text-muted font-weight-bold"></span>
							</td>
							<td>
								<span class="label label-lg label-light-success label-inline">{{client.get_stats.total_income.sum.humanize|intcomma}} ₺</span>
							</td>
							<td>
								<span class="label label-lg label-light-danger  label-inline">{{client.get_stats.total_spent.sum.humanize|intcomma}} ₺</span>
								<span class="text-muted font-weight-bold"></span>
							</td>
							<td>
								<span class="text-dark-75 font-weight-bolder d-block font-size-lg"></span>
								<span class="text-muted font-weight-bold"></span>
							</td>

							<td class="text-right pr-0">

							</td>
						</tr>
					</tbody>
									</table>
									{% if results.has_other_pages %}
									<div class="row">
									  <div class="col-12">
										<ul class="pagination justify-content-center">
											<li class="page-item"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page=1">
												<i class="ki ki-bold-double-arrow-back icon-xs"></i>
											</a></li>
										  {% if results.has_previous %}
											<li class="page-item"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ results.previous_page_number }}">
												<i class="ki ki-bold-arrow-back icon-xs"></i>
											</a></li>
										  {% else %}
											<li class="page-item disabled"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="#">
												<i class="ki ki-bold-arrow-back icon-xs"></i>
											</a></li>
										  {% endif %}

										  {% if results.number|add:'-4' > 1 %}
											<li><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ results.number|add:'-10' }}">&hellip;</a></li>
										  {% endif %}

										  {% for i in results.paginator.page_range %}
											{% if results.number == i %}
											  <li class="page-item disabled"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1 active" href="#">{{ i }}</a></li>
											{% elif i > results.number|add:'-3' and i < results.number|add:'3' %}
											  <li class="page-item"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ i }}">{{ i }}</a></li>
											{% endif %}
										  {% endfor %}

										  {% if results.paginator.num_pages > results.number|add:'2' %}
											  <li><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ results.number|add:'10' }}">&hellip;</a></li>
										  {% endif %}

										  {% if results.has_next %}
											<li class="page-item"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ results.next_page_number }}">
												<i class="ki ki-bold-arrow-next icon-xs"></i>
											</a></li>
										  {% else %}
											<li class="page-item disabled"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="#">
												<i class="ki ki-bold-arrow-next icon-xs"></i>
											</a></li>
										  {% endif %}
											<li class="page-item"><a class="btn btn-icon btn-sm border-0 btn-hover-primary mr-2 my-1" href="?page={{ results.paginator.num_pages }}">
												<i class="ki ki-bold-double-arrow-next icon-xs"></i>
											</a></li>
										</ul>
									  </div>
									</div>
									{% endif %}
						</div>
						<!--end::Table-->
					</div>
					<!--end::Body-->
				</div>
				<!--end::Advance Table Widget 3-->
			</div>
		</div>
		<div class="row">
			<div class="col-lg-6">
				<!--begin::Charts Widget 4-->
				<div class="card card-custom card-stretch gutter-b">
					<!--begin::Header-->
					<div class="card-header h-auto border-0">
						<div class="card-title py-5">
							<h3 class="card-label">
								<span class="d-block text-dark font-weight-bolder">Son 7 Hesap Hareketi</span>
								<span class="d-block text-muted mt-2 font-size-sm">Gelir Gider Durumu</span>
							</h3>
						</div>
					</div>
					<!--end::Header-->
					<!--begin::Body-->
					<div class="card-body">
						<div id="kt_charts_widget_1_chart_client" data-slug="{{client.slug}}"></div>
					</div>
					<!--end::Body-->
				</div>
				<!--end::Charts Widget 4-->
			</div>
		</div>
		<!--end::Row-->

	</div>
	<!--end::Container-->
</div>



{% endblock %}

{% block script %}
<script src="/static/assets/js/init_chart/init_charts_client.js"></script>
{% endblock %}